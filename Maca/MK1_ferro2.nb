(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     50728,       1574]
NotebookOptionsPosition[     48688,       1505]
NotebookOutlinePosition[     49025,       1520]
CellTagsIndexPosition[     48982,       1517]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", "3", "]"}], "=", 
   RowBox[{
    RowBox[{"B", "[", "3", "]"}], "=", "\[Mu]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"A", "[", "4", "]"}], "=", 
   RowBox[{
    RowBox[{"B", "[", "4", "]"}], "=", "\[Eta]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.621809197935299*^9, 3.621809211289597*^9}, {
  3.621811081291605*^9, 3.621811107065564*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Z0", "[", 
   RowBox[{"x0_", ",", "x1_", ",", "x2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{"-", 
     RowBox[{"A", "[", "0", "]"}]}], "]"}], "*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "[", "1", "]"}], "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x0", "+", "x1"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"x1", "+", "x2"}], ")"}]}], ")"}]}], "/", "4"}], ")"}]}], 
   "*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A", "[", "2", "]"}], "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"x0", "*", "x1"}], "+", 
         RowBox[{"x1", "*", "x2"}]}], ")"}]}], "/", "4"}], ")"}]}], "*", 
   RowBox[{"\[Mu]", "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"x0", "*", "x2"}], ")"}]}], "/", "4"}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z1", "[", 
   RowBox[{"x0_", ",", "x2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"B", "[", "0", "]"}]}], "/", "2"}], "]"}], "*", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", "1", "]"}], "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"x0", "+", "x2"}], ")"}]}], "/", "4"}], ")"}]}], "*", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"B", "[", "2", "]"}], "^", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"(", 
        RowBox[{"x0", "*", "x2"}], ")"}]}], "/", "4"}], 
     ")"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrZ0", "[", 
   RowBox[{"x0_", ",", "x2_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"Z0", "[", 
     RowBox[{"x0", ",", "x1", ",", "x2"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"x1", ",", 
      RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.621809237025079*^9, 3.6218092373645287`*^9}, {
  3.621809308580757*^9, 3.621809319035068*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"i", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"x0", "=", 
    RowBox[{"-", "1"}]}], ",", 
   RowBox[{"x0", "\[LessEqual]", "1"}], ",", 
   RowBox[{"x0", "+=", "2"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"x2", "=", 
      RowBox[{"-", "1"}]}], ",", 
     RowBox[{"x2", "\[LessEqual]", "1"}], ",", 
     RowBox[{"x2", "+=", "2"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"leq", "[", "i", "]"}], "=", 
       RowBox[{"Z1", "[", 
        RowBox[{"x0", ",", "x2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"req", "[", 
        RowBox[{"i", "++"}], "]"}], "=", 
       RowBox[{"TrZ0", "[", 
        RowBox[{"x0", ",", "x2"}], "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.621809235317636*^9, {3.621809334245895*^9, 3.621809339561233*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"leq", "[", "0", "]"}], "\[Equal]", 
  RowBox[{"req", "[", "0", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leq", "[", "1", "]"}], "\[Equal]", 
  RowBox[{"req", "[", "1", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leq", "[", "2", "]"}], "\[Equal]", 
  RowBox[{"req", "[", "2", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"leq", "[", "3", "]"}], "\[Equal]", 
  RowBox[{"req", "[", "3", "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"B", "[", "0", "]"}], "2"]}]], " ", 
    SqrtBox[
     RowBox[{"B", "[", "1", "]"}]]}], 
   SuperscriptBox[
    RowBox[{"B", "[", "2", "]"}], 
    RowBox[{"1", "/", "4"}]]], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"A", "[", "0", "]"}]}]], " ", 
     RowBox[{"A", "[", "1", "]"}]}], 
    RowBox[{
     SuperscriptBox["\[Mu]", 
      RowBox[{"1", "/", "4"}]], " ", 
     SqrtBox[
      RowBox[{"A", "[", "2", "]"}]]}]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"A", "[", "0", "]"}]}]], " ", 
     SqrtBox[
      RowBox[{"A", "[", "2", "]"}]]}], 
    SuperscriptBox["\[Mu]", 
     RowBox[{"1", "/", "4"}]]]}]}]], "Output",
 CellChangeTimes->{3.621809349126017*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"B", "[", "0", "]"}], "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"B", "[", "2", "]"}], 
    RowBox[{"1", "/", "4"}]]}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"A", "[", "0", "]"}]}]], " ", 
     SuperscriptBox["\[Mu]", 
      RowBox[{"1", "/", "4"}]]}], 
    SqrtBox[
     RowBox[{"A", "[", "1", "]"}]]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      RowBox[{"A", "[", "0", "]"}]}]], " ", 
    SuperscriptBox["\[Mu]", 
     RowBox[{"1", "/", "4"}]], " ", 
    SqrtBox[
     RowBox[{"A", "[", "1", "]"}]]}]}]}]], "Output",
 CellChangeTimes->{3.621809349128439*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"B", "[", "0", "]"}], "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"B", "[", "2", "]"}], 
    RowBox[{"1", "/", "4"}]]}], "\[Equal]", 
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"A", "[", "0", "]"}]}]], " ", 
     SuperscriptBox["\[Mu]", 
      RowBox[{"1", "/", "4"}]]}], 
    SqrtBox[
     RowBox[{"A", "[", "1", "]"}]]], "+", 
   RowBox[{
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      RowBox[{"A", "[", "0", "]"}]}]], " ", 
    SuperscriptBox["\[Mu]", 
     RowBox[{"1", "/", "4"}]], " ", 
    SqrtBox[
     RowBox[{"A", "[", "1", "]"}]]}]}]}]], "Output",
 CellChangeTimes->{3.621809349130969*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   SuperscriptBox["\[ExponentialE]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"B", "[", "0", "]"}], "2"]}]], 
   RowBox[{
    SqrtBox[
     RowBox[{"B", "[", "1", "]"}]], " ", 
    SuperscriptBox[
     RowBox[{"B", "[", "2", "]"}], 
     RowBox[{"1", "/", "4"}]]}]], "\[Equal]", 
  RowBox[{
   FractionBox[
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      RowBox[{"A", "[", "0", "]"}]}]], 
    RowBox[{
     SuperscriptBox["\[Mu]", 
      RowBox[{"1", "/", "4"}]], " ", 
     RowBox[{"A", "[", "1", "]"}], " ", 
     SqrtBox[
      RowBox[{"A", "[", "2", "]"}]]}]], "+", 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       RowBox[{"A", "[", "0", "]"}]}]], " ", 
     SqrtBox[
      RowBox[{"A", "[", "2", "]"}]]}], 
    SuperscriptBox["\[Mu]", 
     RowBox[{"1", "/", "4"}]]]}]}]], "Output",
 CellChangeTimes->{3.621809349133121*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"SB", "[", "0", "]"}], "=", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"leq", "[", "0", "]"}], "*", 
         RowBox[{"leq", "[", "1", "]"}], "*", 
         RowBox[{"leq", "[", "2", "]"}], "*", 
         RowBox[{"leq", "[", "3", "]"}]}], "\[Equal]", 
        RowBox[{
         RowBox[{"req", "[", "0", "]"}], "*", 
         RowBox[{"req", "[", "1", "]"}], "*", 
         RowBox[{"req", "[", "2", "]"}], "*", 
         RowBox[{"req", "[", "3", "]"}]}]}], ",", 
       RowBox[{"B", "[", "0", "]"}]}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "0", "]"}], "\[Element]", "Reals"}], "&&", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], "\[Element]", "Reals"}], "&&", 
      RowBox[{
       RowBox[{"A", "[", "2", "]"}], "\[Element]", "Reals"}], "&&", 
      RowBox[{
       RowBox[{"C", "[", "1", "]"}], "\[Equal]", "0"}]}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SB", "[", "1", "]"}], "=", 
  RowBox[{
   RowBox[{"Factor", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Factor", "[", 
         RowBox[{
          RowBox[{"leq", "[", "0", "]"}], "/", 
          RowBox[{"leq", "[", "3", "]"}]}], "]"}], "==", 
        RowBox[{"Factor", "[", 
         RowBox[{
          RowBox[{"req", "[", "0", "]"}], "/", 
          RowBox[{"req", "[", "3", "]"}]}], "]"}]}], ",", 
       RowBox[{"B", "[", "1", "]"}]}], "]"}], "]"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SB", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"Factor", "[", 
     RowBox[{"Simplify", "[", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Factor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"leq", "[", "3", "]"}], "*", 
             RowBox[{"leq", "[", "0", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"leq", "[", "1", "]"}], "*", 
             RowBox[{"leq", "[", "2", "]"}]}], ")"}]}], "]"}], "==", 
         RowBox[{"Factor", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"req", "[", "3", "]"}], "*", 
             RowBox[{"req", "[", "0", "]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"req", "[", "1", "]"}], "*", 
             RowBox[{"req", "[", "2", "]"}]}], ")"}]}], "]"}]}], ",", 
        RowBox[{"B", "[", "2", "]"}]}], "]"}], "]"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SBT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Part", "[", 
      RowBox[{
       RowBox[{"SB", "[", "n", "]"}], ",", "1"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", "2"}], "}"}]}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"B", "[", "0", "]"}], "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"Log", "[", 
     FractionBox[
      RowBox[{
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"4", " ", 
         RowBox[{"A", "[", "0", "]"}]}]], " ", 
       SuperscriptBox[
        RowBox[{"A", "[", "1", "]"}], "2"], " ", 
       RowBox[{"A", "[", "2", "]"}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"A", "[", "1", "]"}]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"A", "[", "2", "]"}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"A", "[", "1", "]"}], "2"], " ", 
          RowBox[{"A", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"A", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox[
             RowBox[{"A", "[", "2", "]"}], "2"]}], ")"}]}]}], ")"}]}]], 
     "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.621809367452128*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"B", "[", "1", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], "+", 
       RowBox[{"A", "[", "2", "]"}]}], ")"}]}], 
    RowBox[{"1", "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.621809367470586*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"B", "[", "2", "]"}], "\[Rule]", 
   FractionBox[
    RowBox[{"\[Mu]", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"A", "[", "1", "]"}]}], ")"}], "2"], " ", 
     RowBox[{"A", "[", "2", "]"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"A", "[", "1", "]"}], "+", 
       RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.621809367472392*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SIC", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"B", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Eta]"}], ",", 
    RowBox[{
     RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Mu]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"B", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"B", "[", "1", "]"}], "\[Rule]", "\[Eta]"}], ",", 
   RowBox[{
    RowBox[{"B", "[", "2", "]"}], "\[Rule]", "\[Mu]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.621809446292173*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{"InitRG", ":=", 
  RowBox[{"SAT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "n", "]"}], "\[Rule]", 
       RowBox[{"B", "[", "n", "]"}]}], "/.", "SIC"}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"RG", ":=", 
  RowBox[{"SAT", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"A", "[", "n", "]"}], "\[Rule]", 
       RowBox[{"B", "[", "n", "]"}]}], "/.", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{
        RowBox[{"SBT", "/.", "SAT"}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{
          RowBox[{"\[Mu]", ">", "0"}], "&&", 
          RowBox[{"\[Eta]", ">", "0"}]}]}]}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "0", ",", 
       RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Plug", " ", "in", " ", "the", " ", "initial", " ", "values", " ", "to", 
     " ", "get", " ", "Z1", " ", "with", " ", "3", " ", "variables", " ", 
     RowBox[{"A", "[", 
      RowBox[{"0", ":", "2"}], "]"}], " ", "replacing", " ", 
     RowBox[{
      RowBox[{"B", "[", 
       RowBox[{"0", ":", "2"}], "]"}], ".", " ", "That"}], " ", "is", " ", 
     "the", " ", "exact", " ", "partition", " ", "function", " ", "for", " ", 
     "a", " ", "system", " ", "with", " ", "3", " ", "sites"}], ",", " ", 
    RowBox[{
    "which", " ", "is", " ", "the", " ", "smallest", " ", "cell", " ", "in", 
     " ", "RG"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.621809631082037*^9, 3.621809631696356*^9}, {
  3.62180972313754*^9, 3.621809728891292*^9}}],

Cell[CellGroupData[{

Cell[BoxData["InitRG"], "Input",
 CellChangeTimes->{{3.6218098838659286`*^9, 3.621809884090464*^9}, {
  3.621810251758032*^9, 3.621810252347821*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"A", "[", "1", "]"}], "\[Rule]", "\[Eta]"}], ",", 
   RowBox[{
    RowBox[{"A", "[", "2", "]"}], "\[Rule]", "\[Mu]"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "\[Mu]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.621809885461534*^9, 3.621810252931457*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Test", " ", "using", " ", "exact", " ", "enumeration"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LnZ1", "=", 
     RowBox[{"Log", "[", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{"Sum", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               RowBox[{"A", "[", "0", "]"}]}], "]"}], "*", 
             RowBox[{
              RowBox[{"A", "[", "1", "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"x0", "+", "x1"}], ")"}], "+", 
                   RowBox[{"(", 
                    RowBox[{"x1", "+", "x2"}], ")"}]}], ")"}]}], "/", "4"}], 
               ")"}]}], "*", 
             RowBox[{
              RowBox[{"A", "[", "2", "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"x0", "*", "x1"}], "+", 
                   RowBox[{"x1", "*", "x2"}]}], ")"}]}], "/", "4"}], ")"}]}], 
             "*", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"A", "[", "3", "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"x0", "*", "x2"}], ")"}]}], "/", "4"}], ")"}]}], 
             "*", 
             RowBox[{
              RowBox[{"A", "[", "4", "]"}], "^", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"(", 
                  RowBox[{"x0", "+", "x2"}], ")"}]}], "/", "4"}], ")"}]}]}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"x0", ",", 
              RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"x2", ",", 
          RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"LnZ1", "=", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"A", "[", "0", "]"}]}], "+", 
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LnZ1", "/.", 
         RowBox[{
          RowBox[{"A", "[", "0", "]"}], "\[Rule]", "0"}]}], ")"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"\[Eta]", ">", "0"}]}]}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.621809654384289*^9, 3.621809676287197*^9}, {
  3.6218098103106823`*^9, 3.62180981111016*^9}, {3.621809981414463*^9, 
  3.621810031255808*^9}, {3.621810090802973*^9, 3.6218100910554113`*^9}, {
  3.621810125159725*^9, 3.621810146260716*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"A", "[", "0", "]"}]}], "+", 
  RowBox[{"Log", "[", 
   FractionBox[
    RowBox[{"1", "+", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"\[Eta]", " ", "\[Mu]"}]], " ", 
      SqrtBox[
       RowBox[{"A", "[", "1", "]"}]], " ", 
      SqrtBox[
       RowBox[{"A", "[", "2", "]"}]]}], "+", 
     RowBox[{"2", " ", 
      SqrtBox[
       RowBox[{"\[Eta]", " ", "\[Mu]"}]], " ", 
      SuperscriptBox[
       RowBox[{"A", "[", "1", "]"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SqrtBox[
       RowBox[{"A", "[", "2", "]"}]]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}], "+", 
     RowBox[{"\[Eta]", " ", 
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], "+", 
        RowBox[{"A", "[", "2", "]"}]}], ")"}]}]}], 
    RowBox[{
     SuperscriptBox["\[Mu]", 
      RowBox[{"1", "/", "4"}]], " ", 
     RowBox[{"A", "[", "1", "]"}], " ", 
     SqrtBox[
      RowBox[{"\[Eta]", " ", 
       RowBox[{"A", "[", "2", "]"}]}]]}]], "]"}]}]], "Output",
 CellChangeTimes->{3.621810095212442*^9, 3.6218101493054333`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Theta]", "[", 
   RowBox[{"k_", ",", "x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"a", ",", "b"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"k", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{"\[Eta]", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"x", "+", "y", "+", "z"}], ")"}]}], "/", "2"}], ")"}]}], 
        "*", 
        RowBox[{"\[Mu]", "^", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"x", "*", "y"}], "+", 
              RowBox[{"y", "*", "z"}], "+", 
              RowBox[{"x", "*", "z"}]}], ")"}]}], "/", "4"}], ")"}]}]}], 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", 
       RowBox[{"Expand", "[", 
        RowBox[{
         RowBox[{"\[Mu]", "^", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"x", "*", "z"}], ")"}]}], "/", "4"}], ")"}]}], "*", 
         RowBox[{"\[Eta]", "^", 
          RowBox[{"(", 
           RowBox[{"y", "/", "2"}], ")"}]}], "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Theta]", "[", 
               RowBox[{
                RowBox[{"k", "-", "1"}], ",", "x", ",", "a", ",", "y"}], 
               "]"}], "*", 
              RowBox[{"\[Theta]", "[", 
               RowBox[{
                RowBox[{"k", "-", "1"}], ",", "y", ",", "b", ",", "z"}], 
               "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"a", ",", 
               RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
           
           RowBox[{"{", 
            RowBox[{"b", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}]}], 
        "]"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]",
    "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Z", "[", "k_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"k", ">", "0"}], ",", 
    RowBox[{"Return", "[", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"\[Theta]", "[", 
            RowBox[{
             RowBox[{"k", "-", "1"}], ",", "x", ",", "y", ",", "z"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", 
             RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", 
           RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"z", ",", 
         RowBox[{"-", "1"}], ",", "1", ",", "2"}], "}"}]}], "]"}], "]"}], ",", 
    RowBox[{"Return", "[", "1", "]"}]}], "]"}]}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{"InitRG", "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"RG", " ", "for", " ", "N"}], "=", "3"}], "*)"}], 
  RowBox[{"Factor", "[", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Exp", "[", "LnZ1", "]"}], "/.", "SAT"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"\[Mu]", ">", "0"}], "&&", 
       RowBox[{"\[Eta]", ">", "0"}]}]}]}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"EN", " ", "for", " ", "N"}], "=", "3"}], "*)"}], 
  RowBox[{"Factor", "[", 
   RowBox[{"Z", "[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"They", " ", "shoudl", " ", "be", " ", "the", " ", 
    RowBox[{"same", "**", "And"}], " ", "InitRG", " ", "is", " ", "to", " ", 
    "bring", " ", "the", " ", "SAT", " ", "table", " ", "for", " ", 
    "replacement"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.62181019369414*^9, 3.621810223585112*^9}, {
  3.621810279042404*^9, 3.621810440424095*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"A", "[", "1", "]"}], "\[Rule]", "\[Eta]"}], ",", 
   RowBox[{
    RowBox[{"A", "[", "2", "]"}], "\[Rule]", "\[Mu]"}], ",", 
   RowBox[{"\[Mu]", "\[Rule]", "\[Mu]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.621810191493774*^9, {3.6218103336830473`*^9, 3.621810349970511*^9}, 
   3.621810447685729*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Eta]", "+", 
     SuperscriptBox["\[Eta]", "2"], "+", 
     RowBox[{"3", " ", "\[Eta]", " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["\[Eta]", 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox["\[Mu]", 
    RowBox[{"3", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.621810191493774*^9, {3.6218103336830473`*^9, 3.621810349970511*^9}, 
   3.621810447688792*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", "\[Eta]", "+", 
     SuperscriptBox["\[Eta]", "2"], "+", 
     RowBox[{"3", " ", "\[Eta]", " ", "\[Mu]"}]}], ")"}]}], 
  RowBox[{
   SuperscriptBox["\[Eta]", 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox["\[Mu]", 
    RowBox[{"3", "/", "4"}]]}]]], "Output",
 CellChangeTimes->{
  3.621810191493774*^9, {3.6218103336830473`*^9, 3.621810349970511*^9}, 
   3.621810447691629*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"Calculating", " ", "One"}], "-", 
    RowBox[{"Point", " ", 
     RowBox[{"Functions", ":", " ", "Energy"}]}]}], ",", " ", "X", ",", " ", 
   "CV"}], "*)"}]], "Input",
 CellChangeTimes->{{3.621810901325989*^9, 3.621811002057173*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"\[Eta]", ",", "\[Mu]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"W", "=", 
   RowBox[{"Factor", "[", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"B", "[", "j", "]"}], "/.", "SBT"}], ")"}], ",", 
        RowBox[{"A", "[", "i", "]"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", 
        RowBox[{"dim", "-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "0", ",", 
        RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"It", " ", "returns", " ", "a", " ", "4"}], "-", "by", "-", 
    RowBox[{"4", " ", "Jocobian", " ", "with", " ", "elements", " ", 
     RowBox[{
      RowBox[{"dB", "[", "i", "]"}], "/", 
      RowBox[{"dA", "[", "j", "]"}]}], " ", "at", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"i", "+", "1"}], ",", 
       RowBox[{"j", "+", "1"}]}], ")"}]}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.621810848617365*^9, 3.6218108795474243`*^9}, {
  3.6218110070092916`*^9, 3.621811075733329*^9}, {3.621811294775118*^9, 
  3.621811300699465*^9}, {3.621811366434906*^9, 3.621811421448262*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"A", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"A", "[", "2", "]"}]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"A", "[", "1", "]"}], " ", 
            RowBox[{"A", "[", "2", "]"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox[
             RowBox[{"A", "[", "1", "]"}], "2"], " ", 
            RowBox[{"A", "[", "2", "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], " ", 
            SuperscriptBox[
             RowBox[{"A", "[", "2", "]"}], "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"A", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], " ", 
            RowBox[{"A", "[", "2", "]"}]}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"A", "[", "1", "]"}]}], "+", 
        RowBox[{"A", "[", "2", "]"}], "+", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"A", "[", "1", "]"}], "2"], " ", 
         RowBox[{"A", "[", "2", "]"}]}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], " ", 
           RowBox[{"A", "[", "2", "]"}]}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"\[Mu]", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"A", "[", "1", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"A", "[", "1", "]"}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], "2"], " ", 
        RowBox[{"A", "[", "2", "]"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], " ", 
            RowBox[{"A", "[", "2", "]"}]}]}], ")"}], "2"]}]], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"A", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], " ", 
            RowBox[{"A", "[", "2", "]"}]}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"A", "[", "1", "]"}]}], ")"}], " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"A", "[", "1", "]"}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], " ", 
            RowBox[{"A", "[", "2", "]"}]}]}], ")"}], "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Mu]", " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"A", "[", "1", "]"}]}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"A", "[", "2", "]"}]}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"A", "[", "1", "]"}], "+", 
            RowBox[{"A", "[", "2", "]"}]}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{
             RowBox[{"A", "[", "1", "]"}], " ", 
             RowBox[{"A", "[", "2", "]"}]}]}], ")"}], "2"]}]]}], "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"A", "[", "1", "]"}]}], ")"}], "2"], " ", 
        RowBox[{"A", "[", "2", "]"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"A", "[", "1", "]"}], "+", 
          RowBox[{"A", "[", "2", "]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], " ", 
           RowBox[{"A", "[", "2", "]"}]}]}], ")"}]}]], "1", "0"},
     {"0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.62181130232203*^9, 3.6218114227163467`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\[CapitalUpsilon]", "]"}]], "Input",
 CellChangeTimes->{{3.6218515055430603`*^9, 3.621851510341395*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"InitRGW", ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"InitRG", ";", "\[IndentingNewLine]", 
      RowBox[{"\[CapitalUpsilon]", "=", 
       RowBox[{"Array", "[", 
        RowBox[{"KroneckerDelta", ",", 
         RowBox[{"{", 
          RowBox[{"dim", ",", "dim"}], "}"}]}], "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"RGW", ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[CapitalUpsilon]", "=", 
       RowBox[{"Together", "[", 
        RowBox[{"\[CapitalUpsilon]", ".", 
         RowBox[{"(", 
          RowBox[{"W", "/.", "SAT"}], ")"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "RG", ";"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.621810887269163*^9, 3.621810894840499*^9}, {
   3.621811444187849*^9, 3.6218114464199*^9}, {3.621812170219157*^9, 
   3.6218121705174227`*^9}, 3.6218125984196997`*^9, {3.621851421018262*^9, 
   3.621851423554146*^9}, {3.6218514932553463`*^9, 3.621851515279139*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{"InitRGW", "\[IndentingNewLine]", 
 RowBox[{"\[CapitalUpsilon]", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6218515294017487`*^9, 3.621851546378586*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"},
     {"0", "0", "0", "1", "0"},
     {"0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6218515474105577`*^9, 3.621851679375882*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"RGW", "\[IndentingNewLine]", 
 RowBox[{"\[CapitalUpsilon]", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.621851553604177*^9, 3.621851571394341*^9}, {
  3.6218516345558767`*^9, 3.621851637652164*^9}, {3.62185168311325*^9, 
  3.6218516918408527`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"2", "0", "0", "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", 
           RowBox[{"2", " ", "\[Mu]"}], "+", 
           RowBox[{"2", " ", "\[Eta]", " ", "\[Mu]"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["\[Eta]", "2"], " ", "\[Mu]"}], "+", 
           RowBox[{"\[Eta]", " ", 
            SuperscriptBox["\[Mu]", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", "\[Eta]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", "\[Mu]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "\[Eta]"}], "+", "\[Mu]", "+", 
        RowBox[{
         SuperscriptBox["\[Eta]", "2"], " ", "\[Mu]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "\[Eta]"}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], "2"], " ", 
        SuperscriptBox["\[Mu]", "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", "\[Mu]"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}], "2"]}]], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Eta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Mu]"}], ")"}]}], 
        RowBox[{"2", " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"\[Eta]", "+", "\[Mu]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Eta]"}], ")"}], " ", "\[Eta]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Eta]"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}], "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[Eta]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", "\[Eta]"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Mu]"}], ")"}], " ", "\[Mu]", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Mu]"}], ")"}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Eta]", "+", "\[Mu]"}], ")"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}], "2"]}]]}], "0", "0"},
     {"0", "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", "\[Eta]"}], ")"}], "2"], " ", "\[Mu]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Eta]", "+", "\[Mu]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"\[Eta]", " ", "\[Mu]"}]}], ")"}]}]], "1", "0"},
     {"0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6218515618227663`*^9, 3.621851573671706*^9}, 
   3.621851641577044*^9, {3.621851684993178*^9, 3.621851692636807*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6218110224531717`*^9, 3.6218110271204967`*^9}, {
  3.62181203435718*^9, 3.621812034943864*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "First", " ", "derivative", " ", "of", " ", "the", " ", "elementary", " ", 
   "PF"}], "*)"}]], "Input",
 CellChangeTimes->{{3.621851791842634*^9, 3.621851804284752*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DLnZ1", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"LnZ1", ",", 
         RowBox[{"A", "[", "i", "]"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"dim", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{
       RowBox[{"\[Mu]", ">", "0"}], "&&", 
       RowBox[{"\[Eta]", ">", "0"}], "&&", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], ">", "0"}], "&&", 
       RowBox[{
        RowBox[{"A", "[", "2", "]"}], ">", "0"}]}]}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.621851807240694*^9, 3.621851914509098*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"\[Eta]", " ", 
      SuperscriptBox[
       RowBox[{"A", "[", "1", "]"}], "2"]}], "-", 
     SqrtBox[
      RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
       RowBox[{"A", "[", "1", "]"}], " ", 
       RowBox[{"A", "[", "2", "]"}]}]], "+", 
     SqrtBox[
      RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
       SuperscriptBox[
        RowBox[{"A", "[", "1", "]"}], "3"], " ", 
       RowBox[{"A", "[", "2", "]"}]}]]}], 
    RowBox[{
     RowBox[{"A", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"\[Eta]", " ", 
        SuperscriptBox[
         RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          RowBox[{"A", "[", "1", "]"}], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          SuperscriptBox[
           RowBox[{"A", "[", "1", "]"}], "3"], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}]}], ")"}]}]], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     RowBox[{"\[Eta]", " ", 
      SuperscriptBox[
       RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}], "+", 
     RowBox[{"\[Eta]", " ", 
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}]}], 
    RowBox[{"2", " ", 
     RowBox[{"A", "[", "2", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"\[Eta]", " ", 
        SuperscriptBox[
         RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          RowBox[{"A", "[", "1", "]"}], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          SuperscriptBox[
           RowBox[{"A", "[", "1", "]"}], "3"], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}]}], ")"}]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[Eta]", " ", 
      RowBox[{"(", 
       RowBox[{
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]"}]], "+", 
        RowBox[{"\[Eta]", " ", 
         SqrtBox[
          RowBox[{"\[Eta]", " ", "\[Mu]"}]], " ", 
         SuperscriptBox[
          RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{
         SqrtBox[
          RowBox[{"\[Eta]", " ", "\[Mu]"}]], " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"A", "[", "2", "]"}]}], "+", 
        RowBox[{"\[Eta]", " ", 
         SqrtBox[
          RowBox[{"\[Eta]", " ", "\[Mu]"}]], " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"A", "[", "2", "]"}]}], "-", 
        RowBox[{"2", " ", "\[Eta]", " ", "\[Mu]", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"A", "[", "1", "]"}], " ", 
           RowBox[{"A", "[", "2", "]"}]}]]}], "-", 
        RowBox[{"2", " ", "\[Eta]", " ", "\[Mu]", " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"A", "[", "1", "]"}], "3"], " ", 
           RowBox[{"A", "[", "2", "]"}]}]]}]}], ")"}]}], 
     RowBox[{"4", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"\[Eta]", " ", "\[Mu]"}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"\[Eta]", " ", 
         SuperscriptBox[
          RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"A", "[", "2", "]"}]}], "+", 
        RowBox[{"\[Eta]", " ", 
         RowBox[{"A", "[", "1", "]"}], " ", 
         RowBox[{"A", "[", "2", "]"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
           RowBox[{"A", "[", "1", "]"}], " ", 
           RowBox[{"A", "[", "2", "]"}]}]]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
           SuperscriptBox[
            RowBox[{"A", "[", "1", "]"}], "3"], " ", 
           RowBox[{"A", "[", "2", "]"}]}]]}]}], ")"}]}]]}], ",", 
   FractionBox[
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"\[Eta]", " ", 
      SuperscriptBox[
       RowBox[{"A", "[", "1", "]"}], "2"]}], "-", 
     RowBox[{
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}], "+", 
     RowBox[{"\[Eta]", " ", 
      RowBox[{"A", "[", "1", "]"}], " ", 
      RowBox[{"A", "[", "2", "]"}]}]}], 
    RowBox[{"2", " ", "\[Eta]", " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"\[Eta]", " ", 
        SuperscriptBox[
         RowBox[{"A", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"\[Eta]", " ", 
        RowBox[{"A", "[", "1", "]"}], " ", 
        RowBox[{"A", "[", "2", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          RowBox[{"A", "[", "1", "]"}], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{"\[Eta]", " ", "\[Mu]", " ", 
          SuperscriptBox[
           RowBox[{"A", "[", "1", "]"}], "3"], " ", 
          RowBox[{"A", "[", "2", "]"}]}]]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.621851916056175*^9}]
}, Open  ]]
},
WindowSize->{1000, 568},
WindowMargins->{{15, Automatic}, {Automatic, 42}},
FrontEndVersion->"9.0 for Linux x86 (64-bit) (February 7, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 500, 15, 77, "Input"],
Cell[1060, 37, 2147, 72, 165, "Input"],
Cell[3210, 111, 990, 27, 165, "Input"],
Cell[CellGroupData[{
Cell[4225, 142, 469, 12, 99, "Input"],
Cell[4697, 156, 961, 34, 66, "Output"],
Cell[5661, 192, 814, 28, 58, "Output"],
Cell[6478, 222, 814, 28, 58, "Output"],
Cell[7295, 252, 942, 33, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8274, 290, 3058, 88, 209, "Input"],
Cell[11335, 380, 1089, 34, 59, "Output"],
Cell[12427, 416, 462, 15, 52, "Output"],
Cell[12892, 433, 651, 21, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13580, 459, 303, 9, 32, "Input"],
Cell[13886, 470, 314, 9, 32, "Output"]
}, Open  ]],
Cell[14215, 482, 1786, 47, 143, "Input"],
Cell[CellGroupData[{
Cell[16026, 533, 149, 2, 32, "Input"],
Cell[16178, 537, 384, 10, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16599, 552, 3039, 82, 143, "Input"],
Cell[19641, 636, 1194, 38, 58, "Output"]
}, Open  ]],
Cell[20850, 677, 3090, 89, 231, "Input"],
Cell[CellGroupData[{
Cell[23965, 770, 1069, 28, 99, "Input"],
Cell[25037, 800, 439, 12, 32, "Output"],
Cell[25479, 814, 527, 16, 59, "Output"],
Cell[26009, 832, 527, 16, 59, "Output"]
}, Open  ]],
Cell[26551, 851, 299, 8, 32, "Input"],
Cell[CellGroupData[{
Cell[26875, 863, 1330, 35, 77, "Input"],
Cell[28208, 900, 6175, 183, 167, "Output"]
}, Open  ]],
Cell[34398, 1086, 142, 2, 32, "Input"],
Cell[34543, 1090, 1193, 29, 187, "Input"],
Cell[CellGroupData[{
Cell[35761, 1123, 179, 2, 55, "Input"],
Cell[35943, 1127, 777, 21, 113, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36757, 1153, 274, 4, 55, "Input"],
Cell[37034, 1159, 4452, 129, 172, "Output"]
}, Open  ]],
Cell[41501, 1291, 144, 2, 32, "Input"],
Cell[41648, 1295, 213, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[41886, 1304, 759, 22, 77, "Input"],
Cell[42648, 1328, 6024, 174, 342, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
